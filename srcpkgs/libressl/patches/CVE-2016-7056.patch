Avoid possible side-channel leak of ECDSA private keys when signing.
--- crypto/ecdsa/ecs_ossl.c
+++ crypto/ecdsa/ecs_ossl.c
@@ -141,6 +141,8 @@ ecdsa_sign_setup(EC_KEY *eckey, BN_CTX *
 		if (BN_num_bits(k) <= BN_num_bits(order))
 			if (!BN_add(k, k, order))
 				goto err;
+
+		BN_set_flags(k, BN_FLG_CONSTTIME);
 
 		/* compute r the x-coordinate of generator * k */
 		if (!EC_POINT_mul(group, tmp_point, k, NULL, NULL, ctx)) {
